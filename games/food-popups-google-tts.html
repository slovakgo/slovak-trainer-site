<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>–ò–≥—Ä–∞: –ü—Ä–æ–¥—É–∫—Ç—ã (SK) ¬∑ —Ñ–æ—Ç–æ + –æ–∑–≤—É—á–∫–∞ Google TTS</title>
<style>
  :root{--ok:#16a34a;--bad:#ef4444;--ink:#1f2937;--muted:#6b7280;--card:#fff;--brand:#00bfa5;}
  html,body{margin:0;background: linear-gradient(135deg, #FFF9DB 0%, #E9F8EE 45%, #FFFFFF 100%);
  .wrap{max-width:1100px;margin:24px auto 56px;padding:0 20px}
  header{display:flex;gap:12px;align-items:center;justify-content:space-between;margin:12px 0 10px;flex-wrap:wrap}
  .pill{border:1px solid #e5e7eb;background:#fff;color:#111827;padding:8px 12px;border-radius:999px;cursor:pointer;font-weight:600}
  .pill.active{background:var(--brand);color:#fff;border-color:transparent}
  h1{font-size:28px;margin:6px 0 2px}
  .meta{color:var(--muted);margin-top:2px}
  .prompt{margin:18px 0 6px;font-size:20px;font-weight:700;}
  .hint{color:var(--muted);font-size:14px}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-top:14px}
  .card{background:var(--card);border-radius:14px;padding:14px;text-align:center;box-shadow:0 10px 28px rgba(0,0,0,.08);
        transform:translateY(8px) scale(.98);opacity:0;animation:pop .35s ease forwards;cursor:pointer;user-select:none;position:relative;overflow:hidden}
  .media{display:grid;place-items:center;height:140px;margin:4px 0 8px}
  .photo{max-width:100%;max-height:140px;border-radius:10px;display:block}
  .fallback{font-size:56px;line-height:1;display:none}
  .sk{font-weight:800;letter-spacing:.2px}
  .card:hover{transform:translateY(0) scale(1);box-shadow:0 14px 32px rgba(0,0,0,.10)}
  .card.correct{outline:3px solid var(--ok);box-shadow:0 0 0 4px rgba(22,163,74,.2) inset}
  .card.wrong{outline:3px solid var(--bad);animation:shake .25s linear}
  @keyframes pop{to{opacity:1;transform:translateY(0) scale(1)}}
  @keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-6px)}75%{transform:translateX(6px)}}
  .toolbar{display:flex;gap:10px;align-items:center;margin-top:14px;flex-wrap:wrap}
  .score{font-weight:800}
  .toast{position:fixed;left:50%;bottom:24px;transform:translateX(-50%);background:#111827;color:#fff;padding:10px 14px;border-radius:10px;opacity:0;pointer-events:none;transition:opacity .2s ease}
  .toast.show{opacity:1}
  .small{font-size:12px;color:var(--muted)}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div>
      <h1>üéÆ –ü—Ä–æ–¥—É–∫—Ç—ã –Ω–∞ —Å–ª–æ–≤–∞—Ü–∫–æ–º ‚Äî —Ñ–æ—Ç–æ + Google TTS</h1>
      <div class="meta" id="meta"></div>
    </div>
    <div style="display:flex;gap:10px;flex-wrap:wrap">
      <div id="lang">
        <button class="pill" data-lang="ua">üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</button>
        <button class="pill active" data-lang="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</button>
        <button class="pill" data-lang="en">üá¨üáß English</button>
      </div>
    </div>
  </header>

  <div class="prompt" id="prompt"></div>
  <div class="hint" id="subhint"></div>

  <div class="grid" id="grid"></div>

  <div class="toolbar">
    <div class="score" id="score">0 / 0</div>
    <span class="small">–ü—Ä–∏ –≤–µ—Ä–Ω–æ–º –æ—Ç–≤–µ—Ç–µ: –æ–∑–≤—É—á–∫–∞ —á–µ—Ä–µ–∑ Google Translate TTS (sk), –∑–∞—Ç–µ–º –∞–≤—Ç–æ-–ø–µ—Ä–µ—Ö–æ–¥</span>
  </div>
</div>

<div class="toast" id="toast">‚úî</div>

<script>
// === –î–∞–Ω–Ω—ã–µ (—Ñ–æ—Ç–æ + —ç–º–æ–¥–∑–∏ —Ñ–æ–ª–±—ç–∫) ===
const ITEMS = [
  { sk:'chlieb',   ua:'—Ö–ª—ñ–±',     ru:'—Ö–ª–µ–±',      en:'bread',  img:'images/chlieb.jpg' },
  { sk:'mlieko',   ua:'–º–æ–ª–æ–∫–æ',   ru:'–º–æ–ª–æ–∫–æ',    en:'milk',   img:'images/mlieko.jpg' },
  { sk:'jablko',   ua:'—è–±–ª—É–∫–æ',   ru:'—è–±–ª–æ–∫–æ',    en:'apple',  img:'images/jablko.jpg' },
  { sk:'syr',      ua:'—Å–∏—Ä',      ru:'—Å—ã—Ä',       en:'cheese', img:'images/syr.jpg' },
  { sk:'vajce',    ua:'—è–π—Ü–µ',     ru:'—è–π—Ü–æ',      en:'egg',    img:'images/vajce.jpg' },
  { sk:'m√§so',     ua:'–º º—è—Å–æ',    ru:'–º—è—Å–æ',      en:'meat',   img:'images/maso.jpg' },
  { sk:'voda',     ua:'–≤–æ–¥–∞',     ru:'–≤–æ–¥–∞',      en:'water',  img:'images/voda.jpg' },
  { sk:'k√°va',     ua:'–∫–∞–≤–∞',     ru:'–∫–æ—Ñ–µ',      en:'coffee', img:'images/kava.jpg' },
  { sk:'cukor',    ua:'—Ü—É–∫–æ—Ä',    ru:'—Å–∞—Ö–∞—Ä',     en:'sugar',  img:'images/cukor.jpg' },
  { sk:'paradajka',ua:'–ø–æ–º—ñ–¥–æ—Ä',  ru:'–ø–æ–º–∏–¥–æ—Ä',   en:'tomato', img:'images/paradajka.jpg' },
  { sk:'kol√°ƒç',    ua:'–ø–∏—Ä—ñ–≥',    ru:'–ø–∏—Ä–æ–≥',     en:'cake',   img:'images/kolac.jpg' },
  { sk:'ry≈æa',     ua:'—Ä–∏—Å',      ru:'—Ä–∏—Å',       en:'rice',   img:'images/ryza.jpg' },
  { sk:'soƒæ',      ua:'—Å—ñ–ª—å',     ru:'—Å–æ–ª—å',      en:'salt',   img:'images/sol.jpg' },
  { sk:'ƒçaj',      ua:'—á–∞–π',      ru:'—á–∞–π',       en:'tea',    img:'images/caj.jpg' },
  { sk:'ban√°n',    ua:'–±–∞–Ω–∞–Ω',    ru:'–±–∞–Ω–∞–Ω',     en:'banana', img:'images/banan.jpg' },
  { sk:'polievka', ua:'—Å—É–ø',      ru:'—Å—É–ø',       en:'soup',   img:'images/polievka.jpg' },
  { sk:'zemiak',   ua:'–∫–∞—Ä—Ç–æ–ø–ª—è', ru:'–∫–∞—Ä—Ç–æ—Ñ–µ–ª—å', en:'potato', img:'images/zemiak.jpg' }
];

const UI={
  ua:{find:'–ó–Ω–∞–π–¥–∏ —Å–ª–æ–≤–æ',help:'–û–±–µ—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç —Å–ª–æ–≤–∞—Ü—å–∫–æ—é',meta:'–ú–æ–≤–∞: –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞'},
  ru:{find:'–ù–∞–π–¥–∏—Ç–µ —Å–ª–æ–≤–æ',help:'–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –Ω–∞ —Å–ª–æ–≤–∞—Ü–∫–æ–º',meta:'–Ø–∑—ã–∫: –†—É—Å—Å–∫–∏–π'},
  en:{find:'Find the word',help:'Pick the correct Slovak word',meta:'Language: English'}
};

let lang='ru',score=0,total=0,current=null,pool=[...ITEMS];

function pick(n,arr){const a=[...arr];const out=[];while(out.length<n&&a.length){out.push(a.splice(Math.floor(Math.random()*a.length),1)[0]);}return out;}

// --- –æ–∑–≤—É—á–∫–∞ —á–µ—Ä–µ–∑ Google Translate TTS (—Å –∑–∞–ø–∞—Å–Ω—ã–º –≤–∞—Ä–∏–∞–Ω—Ç–æ–º speechSynthesis)
function playTTS_SK(text){
  const url = `https://translate.google.com/translate_tts?ie=UTF-8&q=${encodeURIComponent(text)}&tl=sk&client=tw-ob`;
  const audio = new Audio(url);
  audio.play().catch(()=>{
    // fallback ‚Äî –µ—Å–ª–∏ –±—Ä–∞—É–∑–µ—Ä –∑–∞–ø—Ä–µ—Ç–∏–ª –∞–≤—Ç–æ–ø–ª–µ–π / TTS –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è
    if('speechSynthesis' in window){
      const u=new SpeechSynthesisUtterance(text);
      u.lang='sk-SK';
      speechSynthesis.cancel(); speechSynthesis.speak(u);
    }
  });
}

function setLang(l){
  lang=l;
  document.querySelectorAll('#lang .pill').forEach(b=>b.classList.toggle('active', b.dataset.lang===l));
  document.getElementById('meta').textContent=UI[l].meta;
  document.getElementById('subhint').textContent=UI[l].help;
  score=0; total=0; pool=[...ITEMS];
  newRound();
}

function newRound(){
  if(pool.length<4) pool=[...ITEMS];
  const options = pick(4, pool);
  current = options[Math.floor(Math.random()*options.length)];
  total++;
  render(options);
}

function render(options){
  const g=document.getElementById('grid');
  g.innerHTML='';
  document.getElementById('prompt').textContent = `${UI[lang].find}: ‚Äú${current[lang]}‚Äù`;
  document.getElementById('score').textContent = `${score} / ${total-1}`;

  options.forEach((opt,i)=>{
    const el=document.createElement('div');
    el.className='card';
    el.style.animationDelay=`${i*60}ms`;
    const imgId=`img_${i}_${Date.now()}`;
    el.innerHTML=`
      <div class="media">
        <img id="${imgId}" class="photo" alt="${opt.sk}">
        <div class="fallback">${opt.emoji}</div>
      </div>
      <div class="sk">${opt.sk}</div>
    `;
    const img=el.querySelector('.photo'), fb=el.querySelector('.fallback');
    img.src=opt.img;
    img.onload=()=>{ img.style.display='block'; fb.style.display='none'; };
    img.onerror=()=>{ img.style.display='none'; fb.style.display='block'; };

    el.addEventListener('click',()=>{
      if(el.classList.contains('correct')) return;
      if(opt.sk===current.sk){
        el.classList.add('correct');
        score++;
        document.getElementById('score').textContent = `${score} / ${total-1}`;
        playTTS_SK(current.sk);
        toast('‚úî ' + opt.sk);
        setTimeout(newRound, 700); // –∞–≤—Ç–æ-–ø–µ—Ä–µ—Ö–æ–¥
      }else{
        el.classList.add('wrong');
        setTimeout(()=>el.classList.remove('wrong'),300);
      }
    });
    g.appendChild(el);
  });
}

function toast(m){
  const t=document.getElementById('toast');
  t.textContent=m; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'), 800);
}

document.querySelectorAll('#lang .pill').forEach(b=> b.addEventListener('click', ()=> setLang(b.dataset.lang)));
setLang('ru');
// --- —É–ª—É—á—à–µ–Ω–Ω–∞—è –æ–∑–≤—É—á–∫–∞ —Å–ª–æ–≤–∞ –Ω–∞ —Å–ª–æ–≤–∞—Ü–∫–æ–º ---
function speakSK(text){
  // 1) –ø—Ä–æ–±—É–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≥–æ–ª–æ—Å–∞
  const prefer = [
    'Microsoft Filip',          // Edge/Windows
    'Google Slovak',            // Chrome
  ];
  const voices = (typeof speechSynthesis!=='undefined') ? speechSynthesis.getVoices() : [];
  let voice = null;

  if (voices && voices.length){
    voice = voices.find(v => prefer.some(n => v.name && v.name.toLowerCase().includes(n.toLowerCase())))
         ||  voices.find(v => /sk|slovak/i.test((v.lang||'') + ' ' + (v.name||'')));
  }

  if (voice){
    const u = new SpeechSynthesisUtterance(text);
    u.lang = 'sk-SK';
    u.voice = voice;
    u.rate = 0.95;
    u.pitch = 1.0;
    speechSynthesis.cancel();
    speechSynthesis.speak(u);
    return;
  }

  // 2) –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî Google TTS
  const url = 'https://translate.googleapis.com/translate_tts?ie=UTF-8&q='
              + encodeURIComponent(text) + '&tl=sk-SK&client=gtx';
  const audio = new Audio(url);
  audio.play().catch(()=>{});
}
</script>
</body>
</html>

